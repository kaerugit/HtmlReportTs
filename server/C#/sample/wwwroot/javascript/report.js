var DoraReport=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=0]="none",e[e.zero=1]="zero",e[e.currency=2]="currency",e[e.date=3]="date",e[e.parcent=4]="parcent"}(n||(n={}));var a=function(){function e(){}return e.GetFormatType=function(e){var t=n.none;return null!=e&&e.length>0&&("00"==e.substr(0,2)?t=n.zero:"%"==e.substr(-1,1)?t=n.parcent:-1!=e.indexOf("/")||-1!=e.indexOf(":")||-1!=e.indexOf(".f")?t=n.date:-1==e.indexOf(",")&&-1==e.indexOf(".")&&-1==e.indexOf("#")&&"0"!=e||(t=n.currency)),t},e.ParseFormat=function(t,r){if(null==t)return null;if(null==r||0==r.length||0==t.toString().length)return t;var a=e.GetFormatType(r);if(a==n.none)return t;var l=t;switch(t=t.toString(),a==n.parcent&&(r=r.replace("%",""),t=t.replace("%","")),a){case n.zero:t.length>0&&t.length!=r.length&&(t=(t=(r+t).toString()).substr(t.length-r.length));break;case n.currency:case n.parcent:var o=!1,i=t.split("."),u=i[0],s="";i.length>1&&(s=i[1]);var c=(i=r.split("."))[0],p="";if(i.length>1&&(p=i[1]),a==n.parcent&&u.length>0)u=(i=(t=u+(s=(s+="000").substr(0,2)+"."+s.substr(2))).split("."))[0],s="",i.length>1&&(s=i[1]),1==isNaN(+u)?o=!0:u=parseInt(u).toString();-1!=c.indexOf(",")&&(u=u.replace(/\B(?=(\d{3})+(?!\d))/g,","),"0"==t&&"#"==c.substr(-1,1)&&(u="")),s=p.length>0?"."+(s+=p).substring(0,p.length):"",1==o||1==isNaN(+t)?t=l:(t=u+s,a==n.parcent&&t.length>0&&"%"!=t.substr(-1,1)&&(t+="%"));break;case n.date:if(0!=t.length){var g=e.changeDateValue(t);if(null==g||isNaN(+g));else{var d=new Date(+g);t=r;var h=d.getFullYear().toString(),f=(d.getMonth()+1).toString(),D=d.getDate().toString(),m=d.getHours().toString(),v=d.getMinutes().toString(),y=d.getSeconds().toString(),S=d.getMilliseconds().toString()+"000";S=S.substr(0,3),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace("yyyy",h)).replace("yy",h.substr(2))).replace("MM",1==f.length?"0"+f:f)).replace("M",f)).replace("dd",1==D.length?"0"+D:D)).replace("d",D)).replace("HH",1==m.length?"0"+m:m)).replace("H",m)).replace("mm",1==v.length?"0"+v:v)).replace("m",v)).replace("ss",1==y.length?"0"+y:y)).replace("s",y)).replace("fff",S)}}}return t},e.changeDateValue=function(e){e=(e=(e=e.replace("T"," ")).replace("Z","")).replace(/\//g,"-");var t=new RegExp("[^\\:\\-\\s0-9.]");if(e.match(t))return null;var r="000",n=e.split(".");n.length>1&&(e=n[0],r=n[1]);var a=e.split(" "),l=a[0],o="";a.length>1&&(o=a[1]);var i,u=new Date,s=u.getFullYear().toString(),c=(u.getMonth()+1).toString(),p=u.getDate().toString(),g="0",d="0",h="0";if(-1!=e.indexOf(":")&&0==o.length&&(s="1900",c="1",p="1",o=l,l=""),l.length>0)if(2==(i=l.split("-")).length)4==i[0].length?(s=i[0],c=i[1],p="1"):(c=i[0],p=i[1]);else{if(3!=i.length)return null;s=2==i[0].length?s.substring(0,2)+i[0]:i[0],c=i[1],p=i[2]}if(o.length>0)if(2==(i=o.split(":")).length)g=i[0],d=i[1],h="0";else{if(3!=i.length)return null;g=i[0],d=i[1],h=i[2]}return u=new Date(+s,parseInt(c)-1,+p,+g,+d,+h,+r),parseInt(u.getFullYear().toString())!=parseInt(s)||parseInt((u.getMonth()+1).toString())!=parseInt(c)||parseInt(u.getDate().toString())!=parseInt(p)||parseInt(u.getHours().toString())!=parseInt(g)||parseInt(u.getMinutes().toString())!=parseInt(d)||parseInt(u.getSeconds().toString())!=parseInt(h)||parseInt(u.getMilliseconds().toString())!=parseInt(r)?null:u.getTime()},e}();t.Format=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.Report=n.Report,t.FormatEventType=n.FormatEventType,t.ReportSectionSettings=n.ReportSectionSettings,t.ReportPageSectionSetting=n.ReportPageSectionSetting,t.ReportGroupSectionSetting=n.ReportGroupSectionSetting,t.ReportDetailSectionSetting=n.ReportDetailSectionSetting;var a=r(0);t.Format=a.Format},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=r(0);!function(e){e[e.Header=100]="Header",e[e.Footer=200]="Footer",e[e.Detail=0]="Detail",e[e.DetailBlank=10]="DetailBlank"}(n=t.FormatEventType||(t.FormatEventType={}));var l=function(){this.FormatEventFunction=null};t.ReportPageSectionSetting=l;var o=function(){this.IsMergeTable=!0,this.BindField="",this.IsPageRepert=!1,this.IsBreakPage=!1,this.IsPageReset=!1,this.FormatEventFunction=null};t.ReportGroupSectionSetting=o;var i=function(){this.IsMergeTable=!0,this.DetailRepeatCount=0,this.HideDuplicatesField=[],this.FormatEventFunction=null};t.ReportDetailSectionSetting=i;var u=function(){this.Page=new l,this.Group1=new o,this.Group2=new o,this.Group3=new o,this.Group4=new o,this.Group5=new o,this.Group6=new o,this.Group7=new o,this.Group8=new o,this.Group9=new o,this.Detail=new i};t.ReportSectionSettings=u;var s=function(){this.FormatEventFunction=null,this.BindField="",this.IsPageRepert=!1,this.IsBreakPage=!1,this.IsPageReset=!1,this.IsMergeTable=!0,this.DetailRepeatCount=0,this.HideDuplicatesField=[],this.element=null,this.tableElement=null,this.headerElement=null,this.footerElement=null,this.detailElement=null,this.isFirstMergeTable=!1,this.newElement=null,this.appendElement=null,this.findElementName=""},c=function(){this.Page=new s,this.Group1=new s,this.Group2=new s,this.Group3=new s,this.Group4=new s,this.Group5=new s,this.Group6=new s,this.Group7=new s,this.Group8=new s,this.Group9=new s,this.Detail=new s},p=function(){var e=this;this.Data=null,this.MarginCss="",this.ReportEndFunction=null,this.Section=new u,this.reportSectionDatas=new c,this.reportkeys=[],this.groupArray=[],this.pageHeight=0,this.pageFlag=!1,this.sectionMain=null,this.body=null,this.sectionElement=null,this.breakPageHeight=0,this.pageDataCount=0,this.isExistsDetail=!1,this.isPageAutoBreak=!1,this.currentData=null,this.loopCount=0,this.currentTableHeader=null,this.currentTableFooter=null,this.currentPageFooter=null,this.pageExecuteManage=[],this.currentPageDetail=null,this.dummyDiv=null,this.keyBindList=[],this.run=function(){if(null!=e.Data&&0!=e.Data.length){e.pageFlag=!1;var t=document.body.innerHTML;(t.indexOf("[[page]]")>-1||t.indexOf("[[page]]")>-1)&&(e.keyBindList.push("page"),e.keyBindList.push("pages"),e.pageFlag=!0);for(var r=Object.keys(e.Data[0]),a=0;a<r.length;a++)t.match(new RegExp("(\\[\\[("+r[a]+"|"+r[a]+"(\\s)*\\|\\|.+?)\\]\\])","g"))&&e.keyBindList.push(r[a]);if(e.body=document.body,e.init(),null!=e.reportSectionDatas.Detail){var l=e.reportSectionDatas;for(a=0;a<e.reportkeys.length;a++)if(null!=(D=l[e.reportkeys[a]])&&1==D.IsMergeTable){D.isFirstMergeTable=!0;break}e.sectionMain=document.createElement("section"),e.sectionMain.classList.add("sheet"),e.MarginCss.length>0&&e.sectionMain.classList.add(e.MarginCss),e.body.appendChild(e.sectionMain);var o,i=document.defaultView.getComputedStyle(e.sectionMain,null).height;o=+document.defaultView.getComputedStyle(e.sectionMain,null).paddingTop.replace("px","")+ +document.defaultView.getComputedStyle(e.sectionMain,null).paddingBottom.replace("px",""),e.body.removeChild(e.sectionMain),e.pageHeight=Math.floor(+i.replace("px",""))-Math.floor(o);var u=e.Data.length,s=!1,c=null,p=!1;for(e.loopCount=0;e.loopCount<u;e.loopCount++){var g=e.isPageAutoBreak;0==g&&(e.pageExecuteManage=[],g=s),s=!1,e.currentData=e.Data[e.loopCount];var d=!1;e.loopCount==u-1&&(d=!0),(0==e.loopCount||g)&&(c=null,e.addPageFunc()),e.isExistsDetail=!1;var h=!1;for(var f in e.groupArray){var D=e.groupArray[f];if(0==h&&(0==e.loopCount||1==g&&D.IsPageRepert?h=!0:0!=D.BindField.length&&e.currentData[D.BindField]!=e.Data[e.loopCount-1][D.BindField]&&(h=!0,1==e.pageFlag&&1==D.IsPageReset&&((C=document.querySelectorAll("section"))[C.length-1].setAttribute("GroupPage",""),p=!0))),1==h){c=null,1==D.isFirstMergeTable&&e.addGroupFunc("tableappend"+e.loopCount.toString());var m="gh"+f;if(1==g&&D.IsPageRepert&&e.pageExecuteManage.splice(e.pageExecuteManage.indexOf(m),1),null!=D.headerElement){var v=D.headerElement.cloneNode(!0);if(0==e.addElement(n.Header,D,m,v))return;if(1==e.isPageAutoBreak)break}}}if(1!=e.isPageAutoBreak){var y=e.reportSectionDatas.Detail.detailElement.cloneNode(!0),S=null;if(e.reportSectionDatas.Detail.HideDuplicatesField.length>0){if(null!=c)for(S=JSON.parse(JSON.stringify(e.currentData)),a=0;a<e.reportSectionDatas.Detail.HideDuplicatesField.length;a++){var F=e.reportSectionDatas.Detail.HideDuplicatesField[a];S[F]==c[F]&&(S[F]=null)}c=JSON.parse(JSON.stringify(e.currentData))}if(0==e.addElement(n.Detail,e.reportSectionDatas.Detail,"detail",y,S))return;if(!e.isPageAutoBreak){e.isExistsDetail=!0;var b=0;if(0==d)for(var f in b=e.groupArray.length,e.groupArray)if(0!=(D=e.groupArray[f]).BindField.length&&e.currentData[D.BindField]!=e.Data[e.loopCount+1][D.BindField]){b=+f;break}for(f=e.groupArray.length-1;f>=0;f--){D=e.groupArray[f];var E=!1;if(b<=f&&(E=!0),1==E){if(null!=D.footerElement){var P=D.footerElement.cloneNode(!0);if(0==e.addElement(n.Footer,D,"gf"+f,P))return;if(e.isPageAutoBreak)break}if(1==D.isFirstMergeTable&&e.addFooterFunc(!0),D.IsBreakPage){e.addFooterFunc(),s=!0;break}}}e.isPageAutoBreak||1==s||d&&e.addFooterFunc()}}}for(l=e.reportSectionDatas,a=0;a<e.reportkeys.length;a++)null!=l[e.reportkeys[a]]&&null!=l[e.reportkeys[a]].element&&e.body.removeChild(l[e.reportkeys[a]].element);if(1==e.pageFlag){var C=document.querySelectorAll("section");if(1==p)for(var M=0,k=0,w=0;w<C.length;w++){if(0==w||null!=C[w].getAttribute("GroupPage")){for(M=0,k=w+1;k<C.length&&null==C[k].getAttribute("GroupPage");k++);k-=w}M++,e.replaceData(C[w],{page:M,pages:k})}else for(w=0;w<C.length;w++)e.replaceData(C[w],{page:w+1,pages:C.length})}null!=e.ReportEndFunction&&e.ReportEndFunction(),e.body.style.visibility="visible",e.body.classList.add("complete")}else console.log("developError:NoDetail")}},this.init=function(){for(var t=function(t){var r=document.querySelector("[reporttype="+e.reportkeys[t].toLowerCase()+"]");if(null!=r){var n=new s,a=e.Section;if(null!=a[e.reportkeys[t]]){var l=n;Object.keys(a[e.reportkeys[t]]).forEach((function(r,n){l[r]=a[e.reportkeys[t]][r]}))}n.element=r;var o=!1;"group"==e.reportkeys[t].substring(0,5).toLowerCase()&&(o=!0);var i=r.getAttribute("reportproperty");if(null!=i&&i.length>0){var u=JSON.parse(i.replace(/'/g,'"')),c=void 0;null!=(c=u.DetailRepeatCount)&&(n.DetailRepeatCount=c),null!=(c=u.BindField)&&(n.BindField=c),null!=(c=u.IsPageRepert)&&"true"==c.toLocaleLowerCase()&&(n.IsPageRepert=!0),null!=(c=u.IsBreakPage)&&"true"==c.toLocaleLowerCase()&&(n.IsBreakPage=!0),null!=(c=u.HideDuplicatesField)&&(n.HideDuplicatesField=c),null!=(c=u.IsPageReset)&&"true"==c.toLocaleLowerCase()&&(n.IsPageReset=!0),null!=(c=u.IsMergeTable)&&("true"==c.toLocaleLowerCase()?n.IsMergeTable=!0:n.IsMergeTable=!1)}if(0==Array.isArray(n.HideDuplicatesField))return n.HideDuplicatesField=[],{value:void 0};n.isFirstMergeTable=!1;var p=r.querySelector("table");if(1==n.IsMergeTable&&null!=p){if(n.tableElement=p,n.headerElement=p.querySelector("thead"),n.detailElement=p.querySelector("tbody"),n.footerElement=p.querySelector("tfoot"),e.reportkeys[t].toLowerCase()=="detail".toLocaleLowerCase()&&null==n.detailElement)return console.log("developError:NotbodyTag"),{value:void 0}}else n.IsMergeTable=!1,n.headerElement=r.querySelector("header"),n.footerElement=r.querySelector("footer"),n.detailElement=n.element;e.reportSectionDatas[e.reportkeys[t]]=n,1==o&&e.groupArray.push(n)}},r=0;r<e.reportkeys.length;r++){var n=t(r);if("object"==typeof n)return n.value}},this.addGroupFunc=function(t){var r,n=null,a=null;1==e.reportSectionDatas.Detail.IsMergeTable&&((n=null===(r=e.reportSectionDatas.Detail.tableElement)||void 0===r?void 0:r.cloneNode(!0)).removeChild(n.querySelector("tbody")),n.setAttribute(t,""),a=document.createElement("tbody"),n.appendChild(a),e.currentTableHeader=n.querySelector("thead"),e.currentTableFooter=n.querySelector("tfoot"));for(var l=e.reportSectionDatas,o=0;o<e.reportkeys.length;o++){var i=l[e.reportkeys[o]];null!=i&&(null!=n&&1==i.IsMergeTable?(i.newElement=n,i.appendElement=a,i.findElementName=t):(i.newElement=null,i.appendElement=e.currentPageDetail,i.findElementName=""))}},this.addPageFunc=function(){var t;e.sectionElement=e.sectionMain.cloneNode(!0),e.body.appendChild(e.sectionElement),e.isPageAutoBreak=!1,e.pageDataCount=0,e.breakPageHeight=e.pageHeight,e.isExistsDetail=!1,e.currentTableHeader=null,e.currentTableFooter=null,e.currentPageFooter=null;var r=0;if(null!=e.reportSectionDatas.Page.headerElement){var n=e.reportSectionDatas.Page.headerElement.cloneNode(!0);e.replaceData(n,e.currentData),null!=e.reportSectionDatas.Page.FormatEventFunction&&e.reportSectionDatas.Page.FormatEventFunction(!0,n,e.currentData),n.setAttribute("oya",""),e.sectionElement.appendChild(n),r=n.offsetHeight}if(e.breakPageHeight-=r,e.currentPageDetail=document.createElement("div"),e.currentPageDetail.setAttribute("oya",""),e.sectionElement.appendChild(e.currentPageDetail),e.addGroupFunc("tableappend"),e.dummyDiv=document.createElement("div"),e.sectionElement.appendChild(e.dummyDiv),r=0,null!=e.reportSectionDatas.Page.footerElement){var a=e.reportSectionDatas.Page.footerElement.cloneNode(!0);e.currentPageFooter=a,null===(t=e.currentPageFooter)||void 0===t||t.setAttribute("oya",""),e.sectionElement.appendChild(e.currentPageFooter),r=e.currentPageFooter.offsetHeight}e.breakPageHeight-=r,e.breakPageHeight<=0&&console.log("developError:NoDetailHeight")},this.addFooterFunc=function(t){if(void 0===t&&(t=!1),null!=e.currentTableFooter&&null==(n=e.currentTableFooter).getAttribute("end")&&(n.setAttribute("end",""),e.replaceData(n,e.currentData),null!=e.reportSectionDatas.Detail.FormatEventFunction&&e.reportSectionDatas.Detail.FormatEventFunction(!1,n,e.currentData)),0==t){if(0!=e.reportSectionDatas.Detail.DetailRepeatCount&&e.pageDataCount<e.reportSectionDatas.Detail.DetailRepeatCount)for(var r=e.pageDataCount;r<e.reportSectionDatas.Detail.DetailRepeatCount;r++){var n=e.reportSectionDatas.Detail.detailElement.cloneNode(!0);e.replaceData(n,{}),null!=e.reportSectionDatas.Detail.FormatEventFunction&&e.reportSectionDatas.Detail.FormatEventFunction(!0,n,{});var a=e.reportSectionDatas.Detail.IsMergeTable,l=null,o=e.reportSectionDatas.Detail.appendElement;if(a){if((l=n.querySelectorAll("tr")).length>0)for(var i=0;i<l.length;i++)null==o||o.appendChild(l[i])}else null==o||o.appendChild(n);if(e.breakPageHeight<+e.currentPageDetail.offsetHeight){if(null!=l)for(i=0;i<l.length;i++)null==o||o.removeChild(l[i]);else null==o||o.removeChild(n);break}}if(null!=e.currentPageFooter){e.replaceData(e.currentPageFooter,e.currentData),null!=e.reportSectionDatas.Page.FormatEventFunction&&e.reportSectionDatas.Page.FormatEventFunction(!1,e.currentPageFooter,e.currentData);var u=0,s=e.sectionElement.querySelectorAll("[oya]");for(i=0;i<s.length;i++)u+=+s[i].offsetHeight;(u=e.pageHeight-u)>0&&(e.dummyDiv.style.height=u+"px")}}},this.replaceData=function(t,r){for(var n=t.innerHTML,l=Object.keys(r),o=0;o<l.length;o++)-1!=e.keyBindList.indexOf(l[o])&&(n=n.replace(new RegExp("(\\[\\[("+l[o]+"|"+l[o]+"(\\s)*\\|\\|.+?)\\]\\])","g"),(function(t){var n=t.replace(/\[\[/g,"").replace(/\]\]/g,"").replace(/\s/g,""),l="";if(n.toString().indexOf("||")>-1){var o=n.split("||");l=a.Format.ParseFormat(r[o[0]]||"",o[1])}else l=r[n]||"";return e.escape_html(l)})));var i="\\[\\[.+?\\]\\]";n=1==e.pageFlag?n.replace(new RegExp(i,"g"),(function(e){return"[[page]]"==e||"[[pages]]"==e?e:""})):n.replace(new RegExp(i,"g"),""),t.innerHTML=n},this.escape_html=function(e){return"string"!=typeof e?e:e.replace(/[&'`"<>]/g,(function(e){switch(e){case"&":return"&amp;";case"'":return"&#x27;";case"`":return"&#x60;";case'"':return"&quot;";case"<":return"&lt;";case">":return"&gt;"}return e}))},this.addElement=function(t,r,a,l,o){var i,u;if(void 0===o&&(o=null),!(a.length>0&&e.pageExecuteManage.indexOf(a)>-1)){var s=r.IsMergeTable,c=!1;r.findElementName.length>0&&null==e.currentPageDetail.querySelector("["+r.findElementName+"]")&&(c=!0);var p=null;if(c&&null!=r.newElement&&(p=r.newElement,s&&null!=e.currentTableHeader&&(e.replaceData(e.currentTableHeader,e.currentData),null!=e.reportSectionDatas.Detail.FormatEventFunction&&e.reportSectionDatas.Detail.FormatEventFunction(!0,e.currentTableHeader,e.currentData)),null===(i=e.currentPageDetail)||void 0===i||i.appendChild(p)),o=null!=o?o:e.currentData,e.replaceData(l,o),null!=r.FormatEventFunction){var g=!1;(t==n.Header||t==n.DetailBlank)&&(g=!0),r.FormatEventFunction(g,l,o)}var d=null,h=r.appendElement;if(s){if((d=l.querySelectorAll("tr")).length>0)for(var f=0;f<d.length;f++)null==h||h.appendChild(d[f])}else null==h||h.appendChild(l);if(e.breakPageHeight<+e.currentPageDetail.offsetHeight){if(0==e.pageDataCount)return console.log("developError:section one page over"),!1;if(null!=d)for(f=0;f<d.length;f++)null==h||h.removeChild(d[f]);else null==h||h.removeChild(l);null!=p&&(null===(u=e.currentPageDetail)||void 0===u||u.removeChild(p)),e.isPageAutoBreak=!0,e.loopCount--,e.loopCount>=0&&0==e.isExistsDetail&&(e.currentData=e.Data[e.loopCount]),e.addFooterFunc()}else e.pageDataCount++,a.length>0&&e.pageExecuteManage.push(a);return!0}e.pageExecuteManage.splice(e.pageExecuteManage.indexOf(a),1)},this.reportkeys=Object.keys(new c)};t.Report=p}]);